[build]
builder = "NIXPACKS"
buildCommand = "pip install -r requirements.txt && playwright install chromium"
# Watch paths are evaluated from repository root, not root directory
# Use explicit path to ensure changes are detected
watchPatterns = [
  "scrapegoat/**"
]

[deploy]
# startCommand removed - set per-service in Railway Dashboard:
# - scrapegoat (main): python3 main.py (NOT uvicorn app.main:app - main.py is at root!)
# - scrapegoat-worker-swarm: python start_redis_worker.py
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[env]
PYTHONUNBUFFERED = "1"
PORT = "8080"

[environments]
[environments.production]
ENVIRONMENT = "production"
PORT = "8080"